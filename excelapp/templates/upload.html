{% load static %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container mt-5">
    <div class="card shadow-lg p-4 rounded-4">
        {% if error_message %}
          <div class="alert alert-danger mt-4 text-center rounded-pill shadow-sm">
            {{ error_message }}
          </div>
        {% endif %}

        <h3 class="text-center mb-4">Question Bank Format - Excel to CSV Converter</h3>

        <!-- Instructions -->
        <div class="alert alert-info rounded-4 shadow-sm">
            <h5 class="fw-bold">ðŸ“Œ Instructions for Preparing Input the Excel File</h5>
            <ol class="mt-2 mb-0">
                <li>The <b>MCQ topic</b> and <b>sub topic</b> should be according to your teaching plan.</li>
                <li>Map an MCQ to <b>only one Course Outcome</b>, not multiple.</li>
                <li>The <b>Course Outcome</b> value should follow the format <code>CO01, CO02</code> (not <code>CO1, CO2</code>).</li>
                <li>The <b>Question Type</b> should be kept as <code>single select or output</code> only.</li>
                <li>The <b>Group ID</b> should be the same for all questions of the same complexity level 
                    (e.g., <code>1</code> for all "very easy", <code>2</code> for all "easy", etc.).</li>
                <li>The input Excel file must contain the following column names in order:  
                    <code>"Group ID", "Question Type", "Question Content",  
                    "OptionA", "OptionB", "OptionC", "OptionD",  
                    "Answer", "CoureOutcome", "Taxonomy", "Complexity",  
                    "Topic", "Course Sub Topic"</code>
                </li>                    
            </ol>
        </div>

  
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-3">
                <label for="excelfile" class="form-label">Upload Excel File</label>
                <input class="form-control" type="file" id="excelfile" name="excelfile" accept=".xlsx,.xls">
            </div>
            <div class="d-grid">
                <button type="submit" class="btn btn-primary btn-lg rounded-pill shadow-sm">Convert</button>
            </div>
        </form>

        {% if download_link %}
        <div class="alert alert-success mt-4 text-center rounded-pill shadow-sm">
            âœ… Converted file: <a href="{{ download_link }}" class="fw-bold text-decoration-none">Download Here</a>
        </div>
        {% endif %}
        
        {% if sample_preview %}
        <div class="mt-5">
            <h5 class="fw-bold text-center mb-3">ðŸ“‘ Sample Input Preview</h5>
            <div class="table-responsive">
                {{ sample_preview|safe }}
            </div>
        </div>
        <!-- Sample File Download -->
        <div class="text-center mb-4">
            ðŸ“¥ <a href="{% static 'sampleInputQBFormat.xlsx' %}" 
                  class="btn btn-outline-success rounded-pill shadow-sm fw-bold">
                Download Sample Input File
            </a>
        </div>
        
        {% endif %}        
    </div>
</div>
